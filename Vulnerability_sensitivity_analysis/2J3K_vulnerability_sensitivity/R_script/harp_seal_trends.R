
harp_seal_trends <- function(){

# Définition des nouveaux noms de colonnes
column_name <- paste0("LoD ", c(0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 99))

# Création des trois jeux de données pour V2, V4, et V10
Df_merged_harp_seal_V2_F_trends <- Df_merged_harp_seal_V2_F %>%
  filter(Group_name == "Seal harp") %>%
  select(-Group_number, -Group_name) %>%
  rename_with(~ column_name) %>%
  mutate(sensitivity = "V=2")  # Ajout de l'identifiant V2

Df_merged_harp_seal_V4_F_trends <- Df_merged_harp_seal_V4_F %>%
  filter(Group_name == "Seal harp") %>%
  select(-Group_number, -Group_name) %>%
  rename_with(~ column_name) %>%
  mutate(sensitivity = "V=4")  # Ajout de l'identifiant V4

Df_merged_harp_seal_V10_F_trends <- Df_merged_harp_seal_V10_F %>%
  filter(Group_name == "Seal harp") %>%
  select(-Group_number, -Group_name) %>%
  rename_with(~ column_name) %>%
  mutate(sensitivity = "V=10")  # Ajout de l'identifiant V10

# Fusion des trois datasets en un seul
data_long <- bind_rows(Df_merged_harp_seal_V2_F_trends, 
                       Df_merged_harp_seal_V4_F_trends, 
                       Df_merged_harp_seal_V10_F_trends) %>%
  pivot_longer(cols = starts_with("LoD"), 
               names_to = "LoD", 
               values_to = "Biomass") %>%
  mutate(LoD = as.numeric(gsub("LoD ", "", LoD)),
         sensitivity = factor(sensitivity, levels = c("V=2", "V=4", "V=10")))  # Fixer l'ordre des niveaux

# Tracé amélioré avec ggplot
gplot <- ggplot(data_long, aes(x = LoD, y = Biomass, color = sensitivity, group = sensitivity)) +
  geom_line(size = 1.5) +  # Épaissir les lignes
  geom_point(size = 3) +   # Agrandir les points
  theme_minimal(base_size = 16) +  # Agrandir la police globale
  labs(title = "Harp seal Biomass trends across different vulnerability sensitivities",
       x = "Level of Depletion (LoD)",
       y = "Biomass (tons/km²)",
       color = "Sensitivity scenario") +
  theme(
    legend.position = "top",
    legend.text = element_text(size = 14),  # Agrandir texte légende
    legend.title = element_text(size = 16, face = "bold"),  # Agrandir titre légende
    axis.title.x = element_text(size = 18, face = "bold"),  # Axe X
    axis.title.y = element_text(size = 18, face = "bold"),  # Axe Y
    axis.text = element_text(size = 14),  # Texte des axes
    plot.title = element_text(size = 20, face = "bold", hjust = 0.5)  # Titre centré et plus gros
  )

return(gplot)

}

